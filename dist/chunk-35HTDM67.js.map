{"version":3,"sources":["../src/evaluatePostfixShunted.ts"],"names":["evaluatePostfixShunted","postfixTokens","stack","stackType","stateIs","stacktype","isIterState","isNoState","setState","type","handleCase","result","token","a","b","TokenType"],"mappings":"wCAEA,SAASA,EAAuBC,EAAwB,CACtD,IAAMC,EAAe,CAAC,EAEtB,IAAIC,IAEJ,SAASC,EAAQC,EAAsB,CACrC,OAAOA,IAAcF,CACvB,CAEA,SAASG,GAAc,CACrB,OAAOF,GAAwB,GAAKA,GAAwB,GAAKA,GAAsB,CACzF,CAEA,SAASG,GAAY,CACnB,OAAOH,GAAyB,CAClC,CAEA,SAASI,EAASC,EAAiB,CACjCN,EAAYM,CACd,CAEA,SAASC,EAAWC,EAAaC,EAAcC,EAAWC,EAAW,CACnE,OAAQF,EAAM,MAAO,CACnB,IAAK,IACHD,EAASE,EAAIC,EACb,MACF,IAAK,IACHH,EAASE,EAAIC,EACb,MACF,IAAK,IACHH,EAASE,EAAIC,EACb,MACF,IAAK,IACHH,EAASE,EAAIC,EACb,MACF,IAAK,IACHH,EAAS,KAAK,IAAIE,EAAGC,CAAC,EACtB,MACF,QACE,MAAM,IAAI,MAAM,qBAAuBF,EAAM,KAAK,CACtD,CACA,OAAOD,CACT,CAEA,OAAAV,EAAc,QAASW,GAAU,CAC/B,OAAQA,EAAM,KAAM,CAClB,OACEV,EAAM,KAAK,WAAWU,EAAM,KAAK,CAAC,EAClC,MAEF,OACE,IAAME,EAAIZ,EAAM,IAAI,EACdW,EAAIX,EAAM,IAAI,EAEhBS,EAASD,EAAW,OAAQE,EAAOC,EAAGC,CAAC,EAE3CZ,EAAM,KAAKS,CAAM,EACjB,MAEF,OACET,EAAM,KAAKU,EAAM,KAAK,EAClBL,EAAU,GACZC,GAAyB,EAC3B,MAEF,QACE,MAEF,QACE,MAAM,IAAI,MAAM,yBAA2BO,EAAUH,EAAM,IAAI,CAAC,CACpE,CACF,CAAC,EAGMV,EAAM,IAAI,CACnB","sourcesContent":["import { Token, TokenType, StackType } from './cst';\n\nfunction evaluatePostfixShunted(postfixTokens: Token[]) {\n  const stack: any[] = [];\n\n  var stackType = StackType.Unknown;\n\n  function stateIs(stacktype: StackType) {\n    return stacktype === stackType;\n  }\n\n  function isIterState() {\n    return stateIs(StackType.String) || stateIs(StackType.Vector) || stateIs(StackType.List);\n  }\n\n  function isNoState() {\n    return stateIs(StackType.Unknown);\n  }\n\n  function setState(type: StackType) {\n    stackType = type;\n  }\n\n  function handleCase(result: any, token: Token, a: number, b: number) {\n    switch (token.value) {\n      case '+':\n        result = a + b;\n        break;\n      case '-':\n        result = a - b;\n        break;\n      case '*':\n        result = a * b;\n        break;\n      case '/':\n        result = a / b;\n        break;\n      case '^':\n        result = Math.pow(a, b);\n        break;\n      default:\n        throw new Error('Unknown operator: ' + token.value);\n    }\n    return result;\n  }\n\n  postfixTokens.forEach((token) => {\n    switch (token.type) {\n      case TokenType.Number:\n        stack.push(parseFloat(token.value));\n        break;\n\n      case TokenType.Operator:\n        const b = stack.pop()!;\n        const a = stack.pop()!;\n\n        let result = handleCase(void 0, token, a, b);\n\n        stack.push(result);\n        break;\n\n      case TokenType.String:\n        stack.push(token.value);\n        if (isNoState())\n          setState(StackType.String);\n        break;\n\n      case TokenType.EOF:\n        break;\n\n      default:\n        throw new Error('Unexpected TokenType: ' + TokenType[token.type]);\n    }\n  });\n\n  // if (stack.length !== 1) throw new Error('Invalid postfix expression');\n  return stack.pop();\n}\n\nexport { evaluatePostfixShunted }"]}